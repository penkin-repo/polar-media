---
import Icons from "./Icons.astro";
import logo from "../assets/images/svg/logo-main2.svg";

import { headerData } from "../data/info";
const { address, topLinks, bottomLinks } = headerData;
---

<header class="header container">
    <!-- ü¶ú —à–∞–ø–∫–∞ -->
    <nav class="header__top">
        <!-- ü¶ú –∞–¥—Ä–µ—Å -->
        <ul>
            <li>
                <a
                    href={address.href}
                    data-tooltip="–û—Ç–∫—Ä—ã—Ç—å –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã"
                    data-placement="bottom"
                    target="_blank"
                >
                    <Icons icon={address.icon} />
                    <small>{address.label}</small>
                </a>
            </li>
        </ul>
        <!-- ü¶ú —Ç–æ–ø-–±–∞—Ä -->
        <ul>
            {
                topLinks.map((link) => (
                    <li>
                        <a
                            href={link.href}
                            {...(link.isEmail && {
                                "data-tooltip": "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å",
                                "data-placement": "bottom",
                                "data-copy-email": true,
                            })}
                        >
                            <Icons icon={link.icon} />
                            <small>{link.label}</small>
                        </a>
                    </li>
                ))
            }
        </ul>
    </nav>
    <nav class="header__bottom">
        <!-- ü¶ú –ª–æ–≥–æ—Ç–∏–ø -->
        <a href="/" class="header__logo"
            ><img src={logo.src} alt="logo polar media" /></a
        >
        <!-- ü¶ú –∏–∫–æ–Ω–∫–∞ –ø–æ–∏—Å–∫–∞ -->
        <a href="#categorySearchAnchor"><Icons icon="search" /></a>
        <!-- ü¶ú –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–µ –º–µ–Ω—é -->
        <details class="dropdown header__navigation">
            <summary>–ù–∞–≤–∏–≥–∞—Ü–∏—è</summary>
            <!-- ü¶ú –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
            <ul>
                {
                    bottomLinks.map((link) => (
                        <li>
                            <a href={link.href}>{link.label}</a>
                        </li>
                    ))
                }
            </ul>
        </details>
        <!-- üîπ –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
        <details class="dropdown header__mobile-menu">
            <summary><Icons icon="menu" /></summary>
            <!-- ü¶ú –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
            <ul>
                {topLinks.map((link) => (
                    <li>
                      <a
                        href={link.href}
                      >
                        <Icons icon={link.icon} />
                        <small>{link.label}</small>
                      </a>
                    </li>
                  ))}
            </ul>
        </details>
    </nav>
</header>

<style>
    /* ==========================================================================
   Header Component Customizations
   (–°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
   ========================================================================== */

    /* Header */
    header.header {
        padding-block: 0;

        .header__top {
            margin-top: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);

            @media (max-width: 1024px) {
                display: none;
            }

            ul {
                display: flex;
                gap: 26px;
                margin: 0;

                li {
                    padding: 0;

                    a {
                        padding: 0;
                        margin: 0;
                    }
                }
            }
        }

        .header__bottom {
            display: flex;
            gap: 26px;
            align-items: center;
            margin-top: 15px;
            padding-bottom: 15px;
            @media (max-width: 1024px) {
                gap: 10px;
            }
        }

        .header__logo {
            display: flex;
            align-items: center;
            width: 220px;
            flex: 1;

            img {
                height: 40px;
                width: auto;
                display: block;
            }
        }

        .header__navigation {
            margin: 0;
        }

        .header__mobile-menu.dropdown {
            display: none;
            @media (max-width: 1024px) {
                display: block;
            }
            ul {
                right: 0;
                left: auto;
            }
        }
    }
</style>

<script>
    // 1. –ù–∞—Ö–æ–¥–∏–º —Å—Å—ã–ª–∫—É –ø–æ –Ω–∞—à–µ–º—É –Ω–æ–≤–æ–º—É –∞—Ç—Ä–∏–±—É—Ç—É
    const emailLink = document.querySelector(
        "[data-copy-email]",
    ) as HTMLAnchorElement;

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç –Ω–∞—à–µ–ª—Å—è, –ø—Ä–µ–∂–¥–µ —á–µ–º –≤–µ—à–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
    if (emailLink) {
        // 2. –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
        emailLink.addEventListener("click", function (event: MouseEvent) {
            // 3. –û—Ç–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø–æ—á—Ç–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç)
            event.preventDefault();

            // 4. –ü–æ–ª—É—á–∞–µ–º email –∏–∑ –∞—Ç—Ä–∏–±—É—Ç–∞ href –∏ —É–±–∏—Ä–∞–µ–º "mailto:"
            const email = this.href.replace("mailto:", "");

            // 5. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Clipboard API –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
            navigator.clipboard
                .writeText(email)
                .then(() => {
                    // –£–°–ü–ï–•: –ö–æ–¥ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è, –µ—Å–ª–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ

                    // 6. –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –º–µ–Ω—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
                    const originalTooltip = this.dataset.tooltip; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
                    this.dataset.tooltip = "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!";

                    // 7. –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω—É—é –ø–æ–¥—Å–∫–∞–∑–∫—É —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        this.dataset.tooltip = originalTooltip;
                    }, 2000);
                })
                .catch((err) => {
                    // –û–®–ò–ë–ö–ê: –ï—Å–ª–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å
                    console.error("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ—á—Ç—É: ", err);
                    // –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ –ø–æ–¥—Å–∫–∞–∑–∫–µ
                    this.dataset.tooltip = "–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è";
                });
        });
    }
</script>
